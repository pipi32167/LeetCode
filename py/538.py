
import unittest
from util_tree import *


def dfs(root, r):
    if not root:
        return

    r.append(root)
    dfs(root.left, r)
    dfs(root.right, r)

class Solution:
    def convertBST(self, root):
        """
        :type root: TreeNode
        :rtype: TreeNode
        """
        r = []
        dfs(root, r)
        r = sorted(r, key=lambda x: x.val, reverse=True)
        s = 0
        for i in range(len(r)):
            # print(r[i].val)
            s += r[i].val
            r[i].val = s
        return root


class SolutionTest(unittest.TestCase):
    def test_convertBST(self):
        
        s = Solution()
        root = fromListToTree([5, 2, 13])
        expect = [18, 20, 13]
        actual = []
        dfs_pre(s.convertBST(root), actual)
        self.assertListEqual(actual, expect)

        for i in range(200):
            root = fromListToTree(list(range(1000)))
            expect = [499500, 499500, 499497, 499479, 499395, 499035, 497547, 491499, 467115, 369195, 368684, 466860, 368172, 367659, 491372, 466604, 367145, 366630, 466347, 366114, 365597, 497484, 491244, 466089, 365079, 364560, 465830, 364040, 363519, 491115, 465570, 362997, 362474, 465309, 361950, 361425, 499004, 497420, 490985, 465047, 360899, 360372, 464784, 359844, 359315, 490854, 464520, 358785, 358254, 464255, 357722, 357189, 497355, 490722, 463989, 356655, 356120, 463722, 355584, 355047, 490589, 463454, 354509, 353970, 463185, 353430, 352889, 499380, 498972, 497289, 490455, 462915, 352347, 351804, 462644, 351260, 350715, 490320, 462372, 350169, 349622, 462099, 349074, 348525, 497222, 490184, 461825, 347975, 347424, 461550, 346872, 346319, 490047, 461274, 345765, 345210, 460997, 344654, 344097, 498939, 497154, 489909, 460719, 343539, 342980, 460440, 342420, 341859, 489770, 460160, 341297, 340734, 459879, 340170, 339605, 497085, 489630, 459597, 339039, 338472, 459314, 337904, 337335, 489489, 459030, 336765, 336194, 458745, 335622, 335049, 499472, 499364, 498905, 497015, 489347, 458459, 334475, 333900, 458172, 333324, 332747, 489204, 457884, 332169, 331590, 457595, 331010, 330429, 496944, 489060, 457305, 329847, 329264, 457014, 328680, 328095, 488915, 456722, 327509, 326922, 456429, 326334, 325745, 498870, 496872, 488769, 456135, 325155, 324564, 455840, 323972, 323379, 488622, 455544, 322785, 322190, 455247, 321594, 320997, 496799, 488474, 454949, 320399, 319800, 454650, 319200, 318599, 488325, 454350, 317997, 317394, 454049, 316790, 316185, 499347, 498834, 496725, 488175, 453747, 315579, 314972, 453444, 314364, 313755, 488024, 453140, 313145, 312534, 452835, 311922, 311309, 496650, 487872, 452529, 310695, 310080, 452222, 309464, 308847, 487719, 451914, 308229, 307610, 451605, 306990, 306369, 498797, 496574, 487565, 451295, 305747, 305124, 450984, 304500, 303875, 487410, 450672, 303249, 302622, 450359, 301994, 301365, 496497, 487254, 450045, 300735, 300104, 449730, 299472, 298839, 487097, 449414, 298205, 297570, 449097, 296934, 296297, 499494, 499464, 499329, 498759, 496419, 486939, 448779, 295659, 295020, 448460, 294380, 293739, 486780, 448140, 293097, 292454, 447819, 291810, 291165, 496340, 486620, 447497, 290519, 289872, 447174, 289224, 288575, 486459, 446850, 287925, 287274, 446525, 286622, 285969, 498720, 496260, 486297, 446199, 285315, 284660, 445872, 284004, 283347, 486134, 445544, 282689, 282030, 445215, 281370, 280709, 496179, 485970, 444885, 280047, 279384, 444554, 278720, 278055, 485805, 444222, 277389, 276722, 443889, 276054, 275385, 499310, 498680, 496097, 485639, 443555, 274715, 274044, 443220, 273372, 272699, 485472, 442884, 272025, 271350, 442547, 270674, 269997, 496014, 485304, 442209, 269319, 268640, 441870, 267960, 267279, 485135, 441530, 266597, 265914, 441189, 265230, 264545, 498639, 495930, 484965, 440847, 263859, 263172, 440504, 262484, 261795, 484794, 440160, 261105, 260414, 439815, 259722, 259029, 495845, 484622, 439469, 258335, 257640, 439122, 256944, 256247, 484449, 438774, 255549, 254850, 438425, 254150, 253449, 499455, 499290, 498597, 495759, 484275, 438075, 252747, 252044, 437724, 251340, 250635, 484100, 437372, 249929, 249222, 437019, 248514, 247805, 495672, 483924, 436665, 247095, 246384, 436310, 245672, 244959, 483747, 435954, 244245, 243530, 435597, 242814, 242097, 498554, 495584, 483569, 435239, 241379, 240660, 434880, 239940, 239219, 483390, 434520, 238497, 237774, 434159, 237050, 236325, 495495, 483210, 433797, 235599, 234872, 433434, 234144, 233415, 483029, 433070, 232685, 231954, 432705, 231222, 230489, 499269, 498510, 495405, 482847, 432339, 229755, 229020, 431972, 228284, 227547, 482664, 431604, 226809, 226070, 431235, 225330, 224589, 495314, 482480, 430865, 223847, 223104, 430494, 222360, 221615, 482295, 430122, 220869, 220122, 429749, 219374, 218625, 498465, 495222, 482109, 429375, 217875, 217124, 429000, 216372, 215619, 481922, 428624, 214865, 214110, 428247, 213354, 212597, 495129, 481734, 427869, 211839, 211080, 427490, 210320, 209559, 481545, 427110, 208797, 208034, 426729, 207270, 206505, 499499, 499490, 499445, 499247, 498419, 495035, 481355, 426347, 205739, 204972, 425964, 204204, 203435, 481164, 425580, 202665, 201894, 425195, 201122, 200349, 494940, 480972, 424809, 199575, 198800, 424422, 198024, 197247, 480779, 424034, 196469, 195690, 423645, 194910, 194129, 498372, 494844, 480585, 423255, 193347, 192564, 422864, 191780, 190995, 480390, 422472, 190209, 189422, 422079, 188634, 187845, 494747, 480194, 421685, 187055, 186264, 421290, 185472, 184679, 479997, 420894, 183885, 183090, 420497, 182294, 181497, 499224, 498324, 494649, 479799, 420099, 180699, 179900, 419700, 179100, 178299, 479600, 419300, 177497, 176694, 418899, 175890, 175085, 494550, 479400, 418497, 174279, 173472, 418094, 172664, 171855, 479199, 417690, 171045, 170234, 417285, 169422, 168609, 498275, 494450, 478997, 416879, 167795, 166980, 416472, 166164, 165347, 478794, 416064, 164529, 163710, 415655, 162890, 162069, 494349, 478590, 415245, 161247, 160424, 414834, 159600, 158775, 478385, 414422, 157949, 157122, 414009, 156294, 155465, 499434, 499200, 498225, 494247, 478179, 413595, 154635, 153804, 413180, 152972, 152139, 477972, 412764, 151305, 150470, 412347, 149634, 148797, 494144, 477764, 411929, 147959, 147120, 411510, 146280, 145439, 477555, 411090, 144597, 143754, 410669, 142910, 142065, 498174, 494040, 477345, 410247, 141219, 140372, 409824, 139524, 138675, 477134, 409400, 137825, 136974, 408975, 136122, 135269, 493935, 476922, 408549, 134415, 133560, 408122, 132704, 131847, 476709, 407694, 130989, 130130, 407265, 129270, 128409, 499175, 498122, 493829, 476495, 406835, 127547, 126684, 406404, 125820, 124955, 476280, 405972, 124089, 123222, 405539, 122354, 121485, 493722, 476064, 405105, 120615, 119744, 404670, 118872, 117999, 475847, 404234, 117125, 116250, 403797, 115374, 114497, 498069, 493614, 475629, 403359, 113619, 112740, 402920, 111860, 110979, 475410, 402480, 110097, 109214, 402039, 108330, 107445, 493505, 475190, 401597, 106559, 105672, 401154, 104784, 103895, 474969, 400710, 103005, 102114, 400265, 101222, 100329, 499485, 499422, 499149, 498015, 493395, 474747, 399819, 99435, 98540, 399372, 97644, 96747, 474524, 398924, 95849, 94950, 398475, 94050, 93149, 493284, 474300, 398025, 92247, 91344, 397574, 90440, 89535, 474075, 397122, 88629, 87722, 396669, 86814, 85905, 497960, 493172, 473849, 396215, 84995, 84084, 395760, 83172, 82259, 473622, 395304, 81345, 80430, 394847, 79514, 78597, 493059, 473394, 394389, 77679, 76760, 393930, 75840, 74919, 473165, 393470, 73997, 73074, 393009, 72150, 71225, 499122, 497904, 492945, 472935, 392547, 70299, 69372, 392084, 68444, 67515, 472704, 391620, 66585,65654, 391155, 64722, 63789, 492830, 472472, 390689, 62855, 61920, 390222, 60984, 60047, 472239, 389754, 59109, 58170, 389285, 57230, 56289, 497847, 492714, 472005, 388815, 55347, 54404, 388344, 53460, 52515, 471770, 387872, 51569, 50622, 387399, 49674, 48725, 492597, 471534, 386925, 47775, 46824, 386450, 45872, 44919, 471297, 385974, 43965, 43010, 385497, 42054, 41097, 499409, 499094, 497789, 492479, 471059, 385019, 40139, 39180, 384540, 38220, 37259, 470820, 384060, 36297, 35334, 383579, 34370, 33405, 492360, 470580, 383097, 32439, 31472, 382614, 30504, 29535, 470339, 382130, 28565, 27594, 381645, 26622, 25649, 497730, 492240, 470097, 381159, 24675, 23700, 380672, 22724, 21747, 469854, 380184, 20769, 19790, 379695, 18810, 17829, 492119, 469610, 379205, 16847, 15864, 378714, 14880, 13895, 469365, 378222, 12909, 11922, 377729, 10934, 9945, 499065, 497670, 491997, 469119,377235, 8955, 7964, 376740, 6972, 5979, 468872, 376244, 4985, 3990,375747, 2994, 1997, 491874, 468624, 375249, 999, 374750, 468375, 374250, 373749, 497609, 491750, 468125, 373247, 372744, 467874, 372240, 371735, 491625, 467622, 371229, 370722, 467369, 370214, 369705]
            actual = []
            dfs_pre(s.convertBST(root), actual)
            # print(actual)
            self.assertListEqual(actual, expect)



if __name__ == "__main__":
    unittest.main()
